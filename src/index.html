<!DOCTYPE html>
<html>
<head>
  <title>Alpha DB - Database Management</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    :root {
      --primary: #4a6fa5;
      --primary-hover: #385d8a;
      --secondary: #7d8b9a;
      --success: #5b8c5a;
      --danger: #c44569;
      --warning: #e09f3e;
      --light: #f8f5f1;
      --dark: #3a3a3a;
      --border: #d8d2c9;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --accent: #d4a574;
    }

    body {
      background: linear-gradient(135deg, #f8f5f1 0%, #e8e4dc 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid var(--border);
    }

    header {
      background: linear-gradient(135deg, var(--primary) 0%, #5d7ea8 100%);
      color: white;
      padding: 25px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 4px solid var(--accent);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo h1 {
      font-size: 1.8rem;
      font-weight: 600;
    }

    .logo span {
      color: var(--accent);
    }

    .logo-icon {
      font-size: 2rem;
      color: var(--accent);
    }

    .main-content {
      display: grid;
      grid-template-columns: 280px 1fr;
      min-height: 80vh;
    }

    .sidebar {
      background: var(--light);
      padding: 25px;
      border-right: 1px solid var(--border);
      background-color: #f9f7f3;
    }

    .section {
      margin-bottom: 30px;
    }

    .section h3 {
      color: var(--dark);
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--border);
      color: #5d5d5d;
    }

    .db-controls {
      margin-bottom: 25px;
    }

    .db-controls select,
    .db-controls input {
      width: 100%;
      padding: 12px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 0.95rem;
      margin-bottom: 10px;
      transition: border-color 0.3s;
      background: white;
    }

    .db-controls select:focus,
    .db-controls input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-hover);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(74, 111, 165, 0.2);
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    .btn-warning {
      background: var(--warning);
      color: white;
    }

    .btn-danger {
      background: var(--danger);
      color: white;
    }

    .btn-block {
      width: 100%;
      justify-content: center;
      margin-bottom: 8px;
    }

    .quick-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .content-area {
      padding: 30px;
      background: #fefcf8;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .sql-editor-container {
      background: #3a3a3a;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 25px;
      border: 1px solid #5d5d5d;
    }

    .editor-header {
      padding: 18px 25px;
      background: #4a4a4a;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #5d5d5d;
    }

    .editor-header h3 {
      color: white;
      font-size: 1.1rem;
    }

    textarea.sql-input {
      width: 100%;
      min-height: 180px;
      padding: 25px;
      background: #2d2d2d;
      color: #f0e6d2;
      border: none;
      font-family: 'Fira Code', 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
    }

    textarea.sql-input:focus {
      outline: none;
      background: #2a2a2a;
    }

    .editor-footer {
      padding: 15px 25px;
      background: #4a4a4a;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid #5d5d5d;
    }

    .results-container {
      background: white;
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .results-header {
      padding: 18px 25px;
      background: #f5f1ea;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .results-body {
      padding: 25px;
      max-height: 400px;
      overflow-y: auto;
      background: white;
    }

    .tables-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .table-card {
      background: white;
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid var(--border);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .table-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .table-card-header {
      padding: 20px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-hover) 100%);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-card-body {
      padding: 20px;
      background: #fcfaf6;
    }

    .alert {
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      border-left: 4px solid transparent;
    }

    .alert-success {
      background: #f0f7f0;
      color: #3a5c3a;
      border: 1px solid #d8e6d8;
      border-left-color: var(--success);
    }

    .alert-error {
      background: #fdf0f0;
      color: #8a3a3a;
      border: 1px solid #f5d8d8;
      border-left-color: var(--danger);
    }

    .alert-info {
      background: #f0f5fa;
      color: #3a4a6a;
      border: 1px solid #d8e0f0;
      border-left-color: var(--primary);
    }

    .result-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .result-table th {
      background: #f5f1ea;
      padding: 14px 16px;
      text-align: left;
      font-weight: 600;
      color: var(--dark);
      border-bottom: 2px solid var(--border);
    }

    .result-table td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
    }

    .result-table tr:hover {
      background: #f9f7f3;
    }

    .status-bar {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--dark);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 0.9rem;
      box-shadow: var(--shadow);
      z-index: 1000;
      background: rgba(58, 58, 58, 0.95);
      backdrop-filter: blur(10px);
    }

    h2 {
      color: #4a4a4a;
      font-weight: 600;
    }

    select,
    input {
      background: white;
      border: 2px solid #e0dcd4;
    }

    @media (max-width: 1024px) {
      .main-content {
        grid-template-columns: 1fr;
      }

      .sidebar {
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">▣</div>
        <div>
          <h1><span>Alpha</span> DB</h1>
          <small style="color: #94a3b8; font-size: 0.9rem;">Simple RDBMS Interface</small>
        </div>
      </div>
      <div style="color: #94a3b8;">
        <span style="color: #10b981; margin-right: 8px;">●</span>
        <span id="status">Connected</span>
      </div>
    </header>

    <div class="main-content">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="section">
          <h3>Database</h3>
          <div class="db-controls">
            <select id="databaseSelect" onchange="loadDatabase(this.value)">
              <option value="">Select Database</option>
            </select>
            <input type="text" id="newDbName" placeholder="New database name">
            <button class="btn btn-primary btn-block" onclick="createDatabase()">
              Create Database
            </button>
            <button class="btn btn-warning btn-block" onclick="reloadDatabases()" style="margin-top: 10px;">
              Reload Databases
            </button>
          </div>
        </div>

        <div class="section">
          <h3>Quick Actions</h3>
          <div class="quick-actions">
            <button class="btn btn-success btn-block" onclick="createSampleTable()">
              Create Sample Table
            </button>
            <button class="btn btn-warning btn-block" onclick="loadSampleData()">
              Load Sample Data
            </button>
            <button class="btn btn-primary btn-block" onclick="showTables()">
              Show All Tables
            </button>
          </div>
        </div>

        <div class="section">
          <h3>SQL Templates</h3>
          <div class="quick-actions">
            <button class="btn btn-block" onclick="loadTemplate('SELECT')" style="background: #cbd5e1;">
              SELECT Query
            </button>
            <button class="btn btn-block" onclick="loadTemplate('INSERT')" style="background: #cbd5e1;">
              INSERT Query
            </button>
            <button class="btn btn-block" onclick="loadTemplate('UPDATE')" style="background: #cbd5e1;">
              UPDATE Query
            </button>
            <button class="btn btn-block" onclick="loadTemplate('CREATE')" style="background: #cbd5e1;">
              CREATE Table
            </button>
          </div>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="content-area">
        <div id="sqlTab" class="tab-content active">
          <h2 style="margin-bottom: 20px; color: var(--dark);">SQL Query Interface</h2>

          <div class="sql-editor-container">
            <div class="editor-header">
              <h3>SQL Editor</h3>
              <div>
                <button class="btn btn-warning" onclick="formatSQL()">
                  Format
                </button>
                <button class="btn btn-success" onclick="executeSQL()" style="margin-left: 10px;">
                  Execute
                </button>
              </div>
            </div>

            <textarea class="sql-input" id="sqlEditor" placeholder="-- Enter your SQL query here
-- Examples:
-- CREATE TABLE users (id INT PRIMARY KEY AUTO_INCREMENT, name VARCHAR NOT NULL, email VARCHAR UNIQUE)
-- INSERT INTO users (name, email) VALUES ('Alice', 'alice@example.com')
-- SELECT * FROM users WHERE age > 20
-- UPDATE users SET age = 25 WHERE name = 'Alice'
-- DELETE FROM users WHERE id = 1"></textarea>

            <div class="editor-footer">
              <select id="queryHistory" style="flex: 1; padding: 8px; border-radius: 6px; border: 1px solid #2d3748; background: #1a2236; color: white;">
                <option value="">Recent queries...</option>
              </select>
              <button class="btn btn-danger" onclick="clearSQL()" style="margin-left: 10px;">
                Clear
              </button>
            </div>
          </div>

          <div class="results-container">
            <div class="results-header">
              <h3>Results</h3>
              <div id="resultStats" style="color: var(--secondary);">
                0 rows affected
              </div>
            </div>
            <div class="results-body" id="resultsBody">
              <div class="alert alert-info">
                Enter a SQL query above and click Execute to see results here.
              </div>
            </div>
          </div>
        </div>

        <div id="tablesTab" class="tab-content">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: var(--dark);">Database Tables</h2>
            <button class="btn btn-primary" onclick="refreshTables()">
              Refresh
            </button>
          </div>

          <div id="tablesContainer">
            <div class="alert alert-info">
              Select a database to see tables.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="status-bar" id="globalStatus">
    <span style="color: #10b981; margin-right: 8px;">●</span>
    Ready
  </div>

  <script>
    let currentDatabase = '';
    let queryHistory = [];

    // Initialize
    document.addEventListener('DOMContentLoaded', async () => {
      await loadDatabases();
      loadQueryHistory();
      updateStatus('Ready to connect');
    });

    // Database operations
    async function loadDatabases() {
      try {
        const response = await fetch('/api/databases');
        const data = await response.json();

        const select = document.getElementById('databaseSelect');
        select.innerHTML = '<option value="">Select Database</option>';

        if (data.success) {
          // Sort databases alphabetically
          const sortedDbs = data.data.sort();
          
          if (sortedDbs.length > 0) {
            sortedDbs.forEach(db => {
              const option = document.createElement('option');
              option.value = db;
              option.textContent = db;
              select.appendChild(option);
            });
            
            // If there's a current database in sessionStorage, try to select it
            const lastDb = sessionStorage.getItem('lastDatabase');
            if (lastDb && sortedDbs.includes(lastDb)) {
              select.value = lastDb;
              loadDatabase(lastDb);
            } else if (sortedDbs.length > 0) {
              // Auto-select the first database
              select.value = sortedDbs[0];
              loadDatabase(sortedDbs[0]);
            }
          } else {
            // No databases yet
            select.innerHTML += '<option value="" disabled>No databases found</option>';
            updateStatus('No databases found. Create one to get started.');
          }
        } else {
          showAlert('Failed to load databases: ' + data.error, 'error');
          updateStatus('Error loading databases');
        }
      } catch (error) {
        console.error('Error loading databases:', error);
        showAlert('Failed to load databases. The server might be restarting.', 'error');
        updateStatus('Server connection error');
      }
    }

    async function reloadDatabases() {
      try {
        updateStatus('Reloading databases...');
        const response = await fetch('/api/reload-databases', {
          method: 'POST'
        });
        
        const data = await response.json();
        if (data.success) {
          await loadDatabases();
          showAlert(`Reloaded ${data.count} database(s)`, 'success');
          updateStatus('Databases reloaded');
        } else {
          showAlert('Failed to reload databases', 'error');
        }
      } catch (error) {
        showAlert('Failed to reload databases', 'error');
      }
    }

    async function createDatabase() {
      const name = document.getElementById('newDbName').value.trim();
      if (!name) {
        showAlert('Please enter a database name', 'error');
        return;
      }

      // Validate database name
      if (!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(name)) {
        showAlert('Database name must start with a letter and contain only letters, numbers, and underscores', 'error');
        return;
      }

      try {
        updateStatus(`Creating database '${name}'...`);
        const response = await fetch('/api/database/create', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            name
          })
        });

        const data = await response.json();
        if (data.success) {
          showAlert(`Database '${name}' created successfully`, 'success');
          document.getElementById('newDbName').value = '';
          await loadDatabases();
          await loadDatabase(name);
          updateStatus(`Database '${name}' created`);
        } else {
          showAlert(data.error, 'error');
          updateStatus('Database creation failed');
        }
      } catch (error) {
        showAlert('Failed to create database: ' + error.message, 'error');
        updateStatus('Database creation error');
      }
    }

    async function loadDatabase(name) {
      if (!name) return;

      currentDatabase = name;
      sessionStorage.setItem('lastDatabase', name); // Store for next time
      
      updateStatus(`Loading database: ${name}`);
      document.getElementById('status').textContent = `Connected to ${name}`;

      try {
        // Test if database is accessible by trying to list tables
        const response = await fetch(`/api/${name}/tables`);
        const data = await response.json();
        
        if (data.success) {
          showAlert(`Connected to database '${name}' (${data.data.length} tables)`, 'success');
          updateStatus(`Using database: ${name}`);
          
          // Load tables for this database
          await showTables();
        } else {
          showAlert(`Failed to load database '${name}': ${data.error}`, 'error');
          updateStatus('Database load failed');
        }
      } catch (error) {
        showAlert('Failed to connect to database: ' + error.message, 'error');
        updateStatus('Connection error');
      }
    }

    // Table operations
    async function showTables() {
      if (!currentDatabase) {
        showAlert('Please select a database first', 'error');
        return;
      }

      try {
        updateStatus(`Loading tables from ${currentDatabase}...`);
        const response = await fetch(`/api/${currentDatabase}/tables`);
        const data = await response.json();

        const container = document.getElementById('tablesContainer');

        if (data.success && data.data.length > 0) {
          let tablesHTML = `<div class="tables-grid">`;

          for (const table of data.data) {
            const tableData = await fetchTableData(table);

            tablesHTML += `
              <div class="table-card">
                <div class="table-card-header">
                  <h4 style="margin: 0;">${table}</h4>
                  <div>
                    <button class="btn btn-success" onclick="queryTable('${table}')" style="padding: 6px 12px; font-size: 0.8rem;">
                      View
                    </button>
                    <button class="btn btn-danger" onclick="dropTable('${table}')" style="padding: 6px 12px; font-size: 0.8rem; margin-left: 5px;">
                      Delete
                    </button>
                  </div>
                </div>
                <div class="table-card-body">
                  <div style="color: var(--secondary); margin-bottom: 15px;">
                    ${Object.keys(tableData).length > 0 ? Object.keys(tableData[0]).length : 0} columns
                    <span style="margin: 0 10px;">•</span>
                    ${tableData.length} rows
                  </div>
                  ${tableData.length > 0 ? `
                    <div style="max-height: 200px; overflow-y: auto;">
                      <table class="result-table">
                        <thead>
                          <tr>
                            ${Object.keys(tableData[0]).slice(0, 3).map(col => `<th>${col}</th>`).join('')}
                          </tr>
                        </thead>
                        <tbody>
                          ${tableData.slice(0, 3).map(row => `
                            <tr>
                              ${Object.values(row).slice(0, 3).map(val => `<td>${val}</td>`).join('')}
                            </tr>
                          `).join('')}
                        </tbody>
                      </table>
                    </div>
                  ` : `
                    <div style="text-align: center; padding: 20px; color: var(--secondary);">
                      <div style="font-size: 2rem; margin-bottom: 10px;">□</div>
                      <p>Table is empty</p>
                    </div>
                  `}
                  <button class="btn btn-primary" onclick="queryTable('${table}')" style="width: 100%; margin-top: 15px;">
                    View Full Table
                  </button>
                </div>
              </div>
            `;
          }

          tablesHTML += '</div>';
          container.innerHTML = tablesHTML;
          updateStatus(`Loaded ${data.data.length} table(s) from ${currentDatabase}`);
        } else {
          container.innerHTML = `
            <div class="alert alert-info">
              No tables found. Create a table to get started.
            </div>
          `;
          updateStatus(`No tables found in ${currentDatabase}`);
        }
      } catch (error) {
        showAlert('Failed to load tables: ' + error.message, 'error');
        updateStatus('Table load error');
      }
    }

    async function fetchTableData(tableName) {
      try {
        const response = await fetch(`/api/${currentDatabase}/tables/${tableName}`);
        const data = await response.json();
        return data.success ? data.data : [];
      } catch (error) {
        console.error(`Error fetching table data for ${tableName}:`, error);
        return [];
      }
    }

    function queryTable(tableName) {
      document.getElementById('sqlEditor').value = `SELECT * FROM ${tableName} LIMIT 10;`;
      executeSQL();
    }

    async function dropTable(tableName) {
      if (!confirm(`Are you sure you want to drop table "${tableName}"? This action cannot be undone.`)) {
        return;
      }

      try {
        updateStatus(`Dropping table ${tableName}...`);
        const response = await fetch(`/api/${currentDatabase}/tables/${tableName}`, {
          method: 'DELETE'
        });

        const data = await response.json();
        if (data.success) {
          showAlert(`Table '${tableName}' dropped successfully`, 'success');
          await showTables();
          updateStatus(`Table ${tableName} dropped`);
        } else {
          showAlert(data.error, 'error');
          updateStatus('Table drop failed');
        }
      } catch (error) {
        showAlert('Failed to drop table: ' + error.message, 'error');
        updateStatus('Table drop error');
      }
    }

    async function refreshTables() {
      if (!currentDatabase) {
        showAlert('Please select a database first', 'error');
        return;
      }

      updateStatus('Refreshing tables...');
      await showTables();
      showAlert('Tables refreshed', 'success');
    }

    // SQL execution
    async function executeSQL() {
      if (!currentDatabase) {
        showAlert('Please select a database first', 'error');
        return;
      }

      const sql = document.getElementById('sqlEditor').value.trim();

      if (!sql) {
        showAlert('Please enter a SQL query', 'error');
        return;
      }

      // Add to history
      addToHistory(sql);

      updateStatus('Executing query...');

      try {
        const response = await fetch('/api/query', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            database: currentDatabase,
            sql
          })
        });

        const data = await response.json();
        displayResults(data);
        
        if (data.success) {
          updateStatus('Query executed successfully');
        } else {
          updateStatus('Query execution failed');
        }
      } catch (error) {
        showAlert('Failed to execute query: ' + error.message, 'error');
        updateStatus('Query execution error');
      }
    }

    function displayResults(data) {
      const resultsBody = document.getElementById('resultsBody');
      const resultStats = document.getElementById('resultStats');

      if (data.success) {
        if (data.data && Array.isArray(data.data)) {
          const rowCount = data.data.length;
          resultStats.textContent = `${rowCount} row${rowCount !== 1 ? 's' : ''} returned`;

          if (rowCount === 0) {
            resultsBody.innerHTML = `
              <div class="alert alert-success">
                Query executed successfully. 0 rows returned.
              </div>
            `;
          } else {
            const headers = Object.keys(data.data[0]);
            resultsBody.innerHTML = `
              <div style="overflow-x: auto;">
                <table class="result-table">
                  <thead>
                    <tr>
                      ${headers.map(h => `<th>${h}</th>`).join('')}
                    </tr>
                  </thead>
                  <tbody>
                    ${data.data.map(row => `
                      <tr>
                        ${headers.map(h => `<td>${row[h]}</td>`).join('')}
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              </div>
            `;
          }
        } else {
          resultStats.textContent = 'Command executed';
          resultsBody.innerHTML = `
            <div class="alert alert-success">
              ${data.message}
            </div>
          `;
        }
      } else {
        resultStats.textContent = 'Error occurred';
        resultsBody.innerHTML = `
          <div class="alert alert-error">
            ${data.error}
          </div>
        `;
      }
    }

    function addToHistory(sql) {
      // Remove duplicates
      queryHistory = queryHistory.filter(q => q !== sql);
      queryHistory.unshift(sql);
      if (queryHistory.length > 10) queryHistory.pop();

      const select = document.getElementById('queryHistory');
      select.innerHTML = '<option value="">Recent queries...</option>';
      queryHistory.forEach((query, index) => {
        const option = document.createElement('option');
        option.value = query;
        option.textContent = `Query ${index + 1}: ${query.substring(0, 50)}${query.length > 50 ? '...' : ''}`;
        select.appendChild(option);
      });
    }

    function loadQueryHistory() {
      const select = document.getElementById('queryHistory');
      select.addEventListener('change', function () {
        if (this.value) {
          document.getElementById('sqlEditor').value = this.value;
        }
      });
    }

    function formatSQL() {
      const editor = document.getElementById('sqlEditor');
      let sql = editor.value;

      // Simple formatting
      sql = sql
        .replace(/SELECT/gi, '\nSELECT')
        .replace(/FROM/gi, '\nFROM')
        .replace(/WHERE/gi, '\nWHERE')
        .replace(/ORDER BY/gi, '\nORDER BY')
        .replace(/LIMIT/gi, '\nLIMIT')
        .replace(/INSERT INTO/gi, '\nINSERT INTO')
        .replace(/VALUES/gi, '\nVALUES')
        .replace(/UPDATE/gi, '\nUPDATE')
        .replace(/SET/gi, '\nSET')
        .replace(/DELETE FROM/gi, '\nDELETE FROM');

      editor.value = sql.trim();
      showAlert('SQL formatted', 'success');
    }

    function clearSQL() {
      document.getElementById('sqlEditor').value = '';
      showAlert('Editor cleared', 'success');
    }

    // Template functions
    function loadTemplate(type) {
      let template = '';

      switch (type) {
        case 'SELECT':
          template = `SELECT * FROM users WHERE age > 20 ORDER BY name LIMIT 10;`;
          break;
        case 'INSERT':
          template = `INSERT INTO users (name, email, age) VALUES ('John Doe', 'john@example.com', 30);`;
          break;
        case 'UPDATE':
          template = `UPDATE users SET age = 25, active = true WHERE id = 1;`;
          break;
        case 'CREATE':
          template = `CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    category VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);`;
          break;
      }

      document.getElementById('sqlEditor').value = template;
      showAlert(`${type} template loaded`, 'success');
    }

    function createSampleTable() {
      const sampleSQL = `CREATE TABLE IF NOT EXISTS users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE,
    age INT DEFAULT 18,
    active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS products (
    id VARCHAR(10) PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    category VARCHAR(50),
    in_stock BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);`;

      document.getElementById('sqlEditor').value = sampleSQL;
      showAlert('Sample table SQL loaded into editor', 'success');
    }

    function loadSampleData() {
      const sampleData = `-- Insert sample users
INSERT INTO users (username, email, age) VALUES 
('alice123', 'alice@example.com', 25),
('bobsmith', 'bob@example.com', 30),
('charlie_b', 'charlie@example.com', 22);

-- Insert sample products
INSERT INTO products (id, name, price, category) VALUES
('P001', 'Laptop', 999.99, 'Electronics'),
('P002', 'Mouse', 25.50, 'Electronics'),
('P003', 'Desk Chair', 150.00, 'Furniture');`;

      document.getElementById('sqlEditor').value = sampleData;
      showAlert('Sample data SQL loaded into editor', 'success');
    }

    // Utility functions
    function showAlert(message, type) {
      const alert = document.createElement('div');
      alert.className = `alert alert-${type}`;
      alert.innerHTML = `
        <span>${message}</span>
        <button onclick="this.parentElement.remove()" style="margin-left: auto; background: none; border: none; color: inherit; cursor: pointer; font-size: 1.2rem;">
          ×
        </button>
      `;

      const contentArea = document.querySelector('.content-area');
      const firstChild = contentArea.firstChild;
      
      if (firstChild) {
        contentArea.insertBefore(alert, firstChild);
      } else {
        contentArea.appendChild(alert);
      }

      setTimeout(() => {
        if (alert.parentElement) alert.remove();
      }, 5000);
    }

    function updateStatus(message) {
      const statusBar = document.getElementById('globalStatus');
      statusBar.innerHTML = `
        <span style="color: #10b981; margin-right: 8px;">●</span>
        ${message}
      `;
    }
  </script>
</body>
</html>